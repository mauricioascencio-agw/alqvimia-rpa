<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Test Drag & Drop</title>
    <link rel="stylesheet" href="css/styles.css">
    <style>
        body {
            padding: 20px;
            background: #0f172a;
        }
        .test-container {
            display: flex;
            gap: 20px;
            margin: 20px 0;
        }
        .test-source {
            background: #1e293b;
            padding: 20px;
            border-radius: 8px;
            width: 300px;
        }
        .test-target {
            background: #1e293b;
            padding: 20px;
            border-radius: 8px;
            flex: 1;
            min-height: 400px;
            border: 2px dashed #475569;
        }
        .test-target.drag-over {
            border-color: #10b981;
            background: rgba(16, 185, 129, 0.1);
        }
        .test-item {
            background: #334155;
            padding: 12px;
            margin: 8px 0;
            border-radius: 6px;
            cursor: grab;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .test-item:active {
            cursor: grabbing;
        }
        .test-item.dragging {
            opacity: 0.5;
        }
        .dropped-item {
            background: #10b981;
            color: white;
            padding: 12px;
            margin: 8px 0;
            border-radius: 6px;
        }
        #log {
            background: #0f172a;
            padding: 20px;
            border-radius: 8px;
            font-family: monospace;
            color: #00ff00;
            margin-top: 20px;
            max-height: 300px;
            overflow-y: auto;
        }
        .log-line {
            margin: 2px 0;
        }
        .log-success { color: #10b981; }
        .log-error { color: #ef4444; }
        .log-info { color: #3b82f6; }
    </style>
</head>
<body>
    <h1 style="color: white;">üéØ Test de Drag & Drop</h1>

    <div class="test-container">
        <div class="test-source">
            <h3 style="color: white; margin-top: 0;">Componentes (Arrastrables)</h3>

            <div class="test-item" draggable="true" data-action="click">
                <i class="fas fa-mouse-pointer"></i>
                <span>Click</span>
            </div>

            <div class="test-item" draggable="true" data-action="type">
                <i class="fas fa-keyboard"></i>
                <span>Escribir Texto</span>
            </div>

            <div class="test-item" draggable="true" data-action="navigate">
                <i class="fas fa-compass"></i>
                <span>Navegar a URL</span>
            </div>

            <div class="test-item" draggable="true" data-action="delay">
                <i class="fas fa-clock"></i>
                <span>Esperar</span>
            </div>
        </div>

        <div class="test-target" id="dropZone">
            <h3 style="color: white; margin-top: 0;">Canvas (Zona de Drop)</h3>
            <p style="color: #94a3b8;">Arrastra componentes aqu√≠...</p>
            <div id="droppedItems"></div>
        </div>
    </div>

    <div id="log">
        <h3 style="color: #fbbf24; margin-top: 0;">Console Log:</h3>
    </div>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script>
        const log = document.getElementById('log');
        let draggedAction = null;

        function addLog(msg, type = 'info') {
            const div = document.createElement('div');
            div.className = `log-line log-${type}`;
            div.textContent = new Date().toLocaleTimeString() + ' - ' + msg;
            log.appendChild(div);
            log.scrollTop = log.scrollHeight;
            console.log(msg);
        }

        addLog('üöÄ Inicializando test de Drag & Drop', 'success');

        // Configurar drag en items
        const testItems = document.querySelectorAll('.test-item');
        addLog(`‚úÖ Encontrados ${testItems.length} items arrastrables`, 'success');

        testItems.forEach((item, index) => {
            const action = item.getAttribute('data-action');
            addLog(`   Item ${index + 1}: ${action}`, 'info');

            item.addEventListener('dragstart', (e) => {
                draggedAction = action;
                e.dataTransfer.effectAllowed = 'copy';
                e.dataTransfer.setData('text/plain', action);
                item.classList.add('dragging');
                addLog(`üéØ DRAGSTART: ${action}`, 'success');
            });

            item.addEventListener('dragend', (e) => {
                item.classList.remove('dragging');
                addLog(`üîö DRAGEND: ${action}`, 'info');
            });
        });

        // Configurar drop zone
        const dropZone = document.getElementById('dropZone');
        addLog(`‚úÖ Drop zone configurado: ${dropZone.id}`, 'success');

        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'copy';
            dropZone.classList.add('drag-over');
            // Solo logear cada 500ms para no saturar
            if (!dropZone._lastDragOverLog || Date.now() - dropZone._lastDragOverLog > 500) {
                addLog('‚ÜîÔ∏è DRAGOVER: sobre drop zone', 'info');
                dropZone._lastDragOverLog = Date.now();
            }
        });

        dropZone.addEventListener('dragleave', (e) => {
            if (e.target === dropZone) {
                dropZone.classList.remove('drag-over');
                addLog('‚Ü©Ô∏è DRAGLEAVE: sali√≥ del drop zone', 'info');
            }
        });

        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('drag-over');

            addLog(`üì¶ DROP EVENT FIRED!`, 'success');
            addLog(`   Action: ${draggedAction}`, 'success');

            if (draggedAction) {
                const droppedItemsContainer = document.getElementById('droppedItems');
                const newItem = document.createElement('div');
                newItem.className = 'dropped-item';
                newItem.textContent = `‚úÖ ${draggedAction} - ${new Date().toLocaleTimeString()}`;
                droppedItemsContainer.appendChild(newItem);

                addLog(`‚úÖ Item a√±adido al canvas: ${draggedAction}`, 'success');
                draggedAction = null;
            } else {
                addLog(`‚ö†Ô∏è WARNING: No hay acci√≥n para soltar`, 'error');
            }
        });

        addLog('‚úÖ Configuraci√≥n completa. Prueba a arrastrar items!', 'success');
    </script>
</body>
</html>
